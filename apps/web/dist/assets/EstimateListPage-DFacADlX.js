import{c as C,b as S,u as E,j as e}from"./query-BVapmMUr.js";import{r as a,L as k}from"./react-DJjQTIQO.js";import{P as L}from"./PageHeader-o_TcEL5P.js";import{S as F}from"./StatusBadge-DqFGVLZ6.js";import{M as P}from"./MoneyDisplay-DJnLbf4O.js";import{E as z,a as _}from"./EmptyState-CZ0oPKrL.js";import{c as q,l as T}from"./estimates-D7lOcU5t.js";import{C as x,l as n,m as M,A as R,t as g}from"./ui-D1pQdlX7.js";import"./cn-C8nBGPD0.js";import"./client-Bw5oB_ZD.js";import"./index-D_Pr5PJx.js";import"./state-BAZDGeK2.js";function V(){const h=C(),[s,b]=a.useState(""),[t,f]=a.useState("all"),[y,o]=a.useState(!1),[i,d]=a.useState(""),[m,c]=a.useState(""),{data:j=[],isLoading:v}=S({queryKey:["estimates"],queryFn:T}),l=E({mutationFn:q,onSuccess:()=>{h.invalidateQueries({queryKey:["estimates"]}),o(!1),d(""),c(""),g.success("Estimate created")},onError:r=>g.error(r instanceof Error?r.message:"Failed to create estimate")}),u=j.filter(r=>{var p;const N=!s||r.title.toLowerCase().includes(s.toLowerCase())||((p=r.customer_name)==null?void 0:p.toLowerCase().includes(s.toLowerCase())),w=t==="all"||r.status===t;return N&&w});return e.jsxs("div",{className:"space-y-6",children:[e.jsx(L,{title:"Estimates",description:"Create and manage project estimates",icon:x,actions:e.jsxs("button",{onClick:()=>o(!0),className:"flex items-center gap-2 rounded-xl bg-primary px-4 py-2.5 text-sm font-semibold text-primary-foreground shadow-lg shadow-primary/20 transition-all hover:bg-primary-hover",children:[e.jsx(n,{size:18}),"New Estimate"]})}),y&&e.jsxs("div",{className:"rounded-2xl border border-primary/20 bg-surface p-6 shadow-glow",children:[e.jsx("h3",{className:"mb-4 font-heading text-lg font-semibold",children:"Create New Estimate"}),e.jsxs("form",{onSubmit:r=>{r.preventDefault(),i.trim()&&l.mutate({title:i,customer_name:m||void 0})},className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Title *"}),e.jsx("input",{value:i,onChange:r=>d(r.target.value),placeholder:"e.g. Smith Bathroom Remodel",className:"w-full rounded-xl border border-input-border bg-input px-4 py-3 text-sm placeholder:text-muted outline-none focus:border-primary focus:ring-2 focus:ring-primary/20",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Customer Name"}),e.jsx("input",{value:m,onChange:r=>c(r.target.value),placeholder:"e.g. Jane Smith",className:"w-full rounded-xl border border-input-border bg-input px-4 py-3 text-sm placeholder:text-muted outline-none focus:border-primary focus:ring-2 focus:ring-primary/20"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{type:"submit",disabled:l.isPending,className:"flex items-center gap-2 rounded-xl bg-primary px-5 py-2.5 text-sm font-semibold text-primary-foreground shadow-lg shadow-primary/20 hover:bg-primary-hover disabled:opacity-50",children:[l.isPending?e.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-primary-foreground/30 border-t-primary-foreground"}):e.jsx(n,{size:16}),"Create"]}),e.jsx("button",{type:"button",onClick:()=>o(!1),className:"rounded-xl bg-transparent px-4 py-2.5 text-sm text-muted-foreground shadow-none hover:text-foreground",children:"Cancel"})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(M,{size:18,className:"absolute left-3.5 top-1/2 -translate-y-1/2 text-muted"}),e.jsx("input",{value:s,onChange:r=>b(r.target.value),placeholder:"Search estimates...",className:"w-full rounded-xl border border-input-border bg-input py-2.5 pl-10 pr-4 text-sm placeholder:text-muted outline-none focus:border-primary focus:ring-2 focus:ring-primary/20"})]}),e.jsxs("select",{value:t,onChange:r=>f(r.target.value),className:"rounded-xl border border-input-border bg-input px-4 py-2.5 text-sm outline-none focus:border-primary focus:ring-2 focus:ring-primary/20",children:[e.jsx("option",{value:"all",children:"All statuses"}),e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"in_progress",children:"In Progress"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"locked",children:"Locked"})]})]}),v?e.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[1,2,3].map(r=>e.jsxs("div",{className:"animate-skeleton rounded-2xl border border-border bg-surface/80 p-6",children:[e.jsx("div",{className:"mb-3 h-5 w-2/3 rounded bg-border"}),e.jsx("div",{className:"mb-2 h-4 w-1/2 rounded bg-border"}),e.jsx("div",{className:"h-4 w-1/3 rounded bg-border"})]},r))}):u.length===0?e.jsx(z,{icon:x,title:s||t!=="all"?"No estimates match your filters":"No estimates yet",description:s||t!=="all"?"Try adjusting your search or filters":'Click "New Estimate" to get started',action:!s&&t==="all"?e.jsxs("button",{onClick:()=>o(!0),className:"flex items-center gap-2 rounded-xl bg-primary px-4 py-2.5 text-sm font-semibold text-primary-foreground shadow-md hover:bg-primary-hover",children:[e.jsx(n,{size:16})," Create Estimate"]}):void 0}):e.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:u.map(r=>e.jsxs(k,{to:`/estimates/${r.id}`,className:"group rounded-2xl border border-border bg-surface/80 p-6 backdrop-blur-sm transition-all hover:border-primary/30 hover:bg-surface-hover hover:shadow-glow",children:[e.jsxs("div",{className:"mb-3 flex items-start justify-between",children:[e.jsx("h3",{className:"truncate font-heading text-base font-semibold group-hover:text-primary",children:r.title}),e.jsx(R,{size:16,className:"shrink-0 text-muted transition-transform group-hover:translate-x-0.5 group-hover:text-primary"})]}),e.jsx("p",{className:"mb-4 truncate text-sm text-muted-foreground",children:r.customer_name||"No customer assigned"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(F,{status:r.status}),e.jsx(P,{value:r.total,size:"lg"})]}),r.updated_at&&e.jsx("p",{className:"mt-3 text-xs text-muted",children:_(r.updated_at)})]},r.id))})]})}export{V as EstimateListPage};
